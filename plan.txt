обрабатывать правила параллельно.  
  Единственное узкое место - добавление упрощённого правила в список

нормализовывать упрощённую грамматику

строить автомат по нормализованной грамматике и запускать его через корутины: 
  каждый спонтанный переход запускает новую корутину 