обрабатывать правила параллельно.  
  Единственное узкое место - добавление упрощённого правила в список
  (это при преобразовании грамматики к упрощённой)

нормализовывать упрощённую грамматику

строить автомат по нормализованной грамматике и запускать его через корутины: 
  каждый спонтанный переход запускает новую корутину 